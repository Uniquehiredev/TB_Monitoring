<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uttarakhand TB Patient Surveillance Dashboard</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chart.js CDN -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* Custom gradient for header */
        .bg-gradient-purple-blue {
            background: linear-gradient(to right, #7c3aed, #2563eb);
        }

        /* Ensure table is scrollable on mobile */
        @media (max-width: 768px) {
            table {
                display: block;
                overflow-x: auto;
                white-space: nowrap;
            }
        }

        /* Adjust chart container heights */
        .chart-container {
            position: relative;
            width: 100%;
            height: 300px;
        }

        /* Ensure the iframe has no border and fits seamlessly */
        iframe {
            border: none;
            width: 100%;
            height: 200px;
            /* Adjust height to fit the header content */
            display: block;
        }

        /* Ensure the body can scroll vertically and horizontally */
        html,
        body {
            margin: 0;
            padding: 0;
            overflow-x: auto;
            /* Allow horizontal scrolling at the page level */
            overflow-y: auto;
            /* Allow vertical scrolling at the page level */
            height: auto;
            width: auto;
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
        }
        /* Icon styling for user and logout */
        .header-icon {
            font-size: 1.25rem; /* 20px */
            color: #1f2937; /* Gray-800, same as nav links */
            opacity: 0.9;
            transition: opacity 0.2s;
        }
        .header-icon:hover {
            opacity: 1;
        }
        /* Navigation link styling */
        .nav-link {
            color: #1f2937; /* Gray-800 */
            font-size: 1rem; /* 16px */
            font-weight: 500;
            padding: 0.5rem 1rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem; /* Space between icon and text */
            border-radius: 0.25rem; /* Slight rounding for active link */
        }
        .nav-link:hover {
            color: #2563eb; /* Blue-600 on hover */
            text-decoration: underline;
        }
        /* Active link styling */
        .nav-link.active {
            background-color: #000000; /* Black background */
            color: #ffffff; /* White text */
        }
        .nav-link.active:hover {
            color: #ffffff; /* Keep white on hover */
            text-decoration: none; /* Remove underline on hover for active link */
        }
        /* Ensure icons in nav links match text color */
        .nav-link i {
            color: inherit; /* Inherit color from parent (nav-link) */
        }
        /* Adjust header text colors to contrast with white background */
        header h1 {
            color: #1f2937; /* Gray-800 */
        }
        header p {
            color: #6b7280; /* Gray-500 */
        }
        header .user-text {
            color: #1f2937; /* Gray-800 */
        }
    </style>
</head>

<body class="bg-gray-100 font-sans">

    <!-- Include the header using an iframe -->
    <iframe src="../pages/TB_Dash_Header.html" title="Header" id="header-iframe"></iframe>

    <!-- Main Container -->
    <div class="max-w-7xl mx-auto p-4 space-y-6">
        <!-- Header -->
        <div class="bg-gradient-purple-blue text-white p-6 rounded-lg">
            <h1 class="text-3xl font-bold mb-2">Uttarakhand TB Patient Surveillance Dashboard</h1>
            <p class="text-purple-100">Comprehensive patient monitoring and surveillance system in Uttarakhand</p>
            <div class="mt-4 flex items-center space-x-4">
                <div class="flex items-center space-x-2">
                    <span class="font-medium">State: Uttarakhand</span>
                </div>
                <div class="flex items-center space-x-2">
                    <span>Reporting Status: 87%</span>
                </div>
            </div>
        </div>

        <!-- Top Summary Cards -->
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <!-- Program Overview -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6">
                    <h2 class="text-lg font-bold text-purple-600 mb-3">Program Overview</h2>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Total Patients Registered</span>
                            <span class="font-bold text-green-600">2,490</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Total Health Facilities</span>
                            <span class="font-bold text-blue-600">124</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Active Cases</span>
                            <span class="font-bold text-purple-600">797</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Diagnostics Summary -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6">
                    <h2 class="text-lg font-bold text-blue-600 mb-3">Diagnostics Summary</h2>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Sputum Tests</span>
                            <span class="font-bold text-green-600">1,900</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">CB-NAAT Tests</span>
                            <span class="font-bold text-blue-600">700</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">X-rays</span>
                            <span class="font-bold text-purple-600">560</span>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Adherence Monitoring -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6">
                    <h2 class="text-lg font-bold text-green-600 mb-3">Adherence Monitoring</h2>
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Missed Dose Follow-ups</span>
                            <span class="font-bold text-red-600">64</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Field Visits</span>
                            <span class="font-bold text-green-600">378</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-sm text-gray-600">Teleconsultations</span>
                            <span class="font-bold text-blue-600">198</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Row 1 -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- TB Treatment Progress Trend -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6">
                    <h2 class="text-xl font-bold">TB Treatment Progress Trend</h2>
                    <p class="text-sm text-gray-600 mb-4">Patient treatment progress by district in Uttarakhand</p>
                    <div class="chart-container">
                        <canvas id="treatmentTrendChart"></canvas>
                    </div>
                </div>
            </div>
            <!-- New TB Case Registrations by District -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6">
                    <h2 class="text-xl font-bold">New TB Case Registrations by District</h2>
                    <p class="text-sm text-gray-600 mb-4">New patient registrations across districts in Uttarakhand</p>
                    <div class="chart-container">
                        <canvas id="newCaseRegistrationsChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Row 2 -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <!-- District-wise Diagnosis Summary -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6">
                    <h2 class="text-xl font-bold">District-wise Diagnosis Summary</h2>
                    <p class="text-sm text-gray-600 mb-4">Diagnostic activity across districts in Uttarakhand</p>
                    <div class="chart-container">
                        <canvas id="diagnosticSummaryChart"></canvas>
                    </div>
                </div>
            </div>
            <!-- Treatment Outcomes Distribution -->
            <div class="bg-white rounded-lg shadow">
                <div class="p-6">
                    <h2 class="text-xl font-bold">Treatment Outcomes Distribution</h2>
                    <p class="text-sm text-gray-600 mb-4">Overall treatment outcome statistics in Uttarakhand</p>
                    <div class="chart-container">
                        <canvas id="treatmentOutcomesChart"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- District Performance Table -->
        <div class="bg-white rounded-lg shadow">
            <div class="p-6">
                <h2 class="text-xl font-bold">District-Wise TB Program Performance</h2>
                <p class="text-sm text-gray-600 mb-4">Comprehensive performance metrics by district in Uttarakhand</p>
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse border border-gray-300 text-sm">
                        <thead class="bg-gray-50">
                            <tr>
                                <th class="border border-gray-300 px-3 py-2 text-left">S.No</th>
                                <th class="border border-gray-300 px-3 py-2 text-left">District Name</th>
                                <th class="border border-gray-300 px-3 py-2 text-left">Total Patients</th>
                                <th class="border border-gray-300 px-3 py-2 text-left">Under Treatment</th>
                                <th class="border border-gray-300 px-3 py-2 text-left">Completed</th>
                                <th class="border border-gray-300 px-3 py-2 text-left">Missed Doses</th>
                                <th class="border border-gray-300 px-3 py-2 text-left">CB-NAAT Tests</th>
                                <th class="border border-gray-300 px-3 py-2 text-left">Field Visits</th>
                                <th class="border border-gray-300 px-3 py-2 text-left">Teleconsultations</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="hover:bg-gray-50">
                                <td class="border border-gray-300 px-3 py-2">1</td>
                                <td class="border border-gray-300 px-3 py-2 font-medium">Dehradun</td>
                                <td class="border border-gray-300 px-3 py-2">500</td>
                                <td class="border border-gray-300 px-3 py-2">50</td>
                                <td class="border border-gray-300 px-3 py-2">400</td>
                                <td class="border border-gray-300 px-3 py-2 text-red-600 font-medium">2</td>
                                <td class="border border-gray-300 px-3 py-2">40</td>
                                <td class="border border-gray-300 px-3 py-2">30</td>
                                <td class="border border-gray-300 px-3 py-2">20</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="border border-gray-300 px-3 py-2">2</td>
                                <td class="border border-gray-300 px-3 py-2 font-medium">Haridwar</td>
                                <td class="border border-gray-300 px-3 py-2">360</td>
                                <td class="border border-gray-300 px-3 py-2">40</td>
                                <td class="border border-gray-300 px-3 py-2">290</td>
                                <td class="border border-gray-300 px-3 py-2 text-red-600 font-medium">2</td>
                                <td class="border border-gray-300 px-3 py-2">30</td>
                                <td class="border border-gray-300 px-3 py-2">24</td>
                                <td class="border border-gray-300 px-3 py-2">16</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="border border-gray-300 px-3 py-2">3</td>
                                <td class="border border-gray-300 px-3 py-2 font-medium">Nainital</td>
                                <td class="border border-gray-300 px-3 py-2">340</td>
                                <td class="border border-gray-300 px-3 py-2">38</td>
                                <td class="border border-gray-300 px-3 py-2">275</td>
                                <td class="border border-gray-300 px-3 py-2 text-red-600 font-medium">1</td>
                                <td class="border border-gray-300 px-3 py-2">28</td>
                                <td class="border border-gray-300 px-3 py-2">22</td>
                                <td class="border border-gray-300 px-3 py-2">15</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="border border-gray-300 px-3 py-2">4</td>
                                <td class="border border-gray-300 px-3 py-2 font-medium">Almora</td>
                                <td class="border border-gray-300 px-3 py-2">425</td>
                                <td class="border border-gray-300 px-3 py-2">45</td>
                                <td class="border border-gray-300 px-3 py-2">350</td>
                                <td class="border border-gray-300 px-3 py-2 text-red-600 font-medium">2</td>
                                <td class="border border-gray-300 px-3 py-2">36</td>
                                <td class="border border-gray-300 px-3 py-2">26</td>
                                <td class="border border-gray-300 px-3 py-2">18</td>
                            </tr>
                            <tr class="hover:bg-gray-50">
                                <td class="border border-gray-300 px-3 py-2">5</td>
                                <td class="border border-gray-300 px-3 py-2 font-medium">Udham Singh Nagar</td>
                                <td class="border border-gray-300 px-3 py-2">295</td>
                                <td class="border border-gray-300 px-3 py-2">33</td>
                                <td class="border border-gray-300 px-3 py-2">240</td>
                                <td class="border border-gray-300 px-3 py-2 text-red-600 font-medium">1</td>
                                <td class="border border-gray-300 px-3 py-2">24</td>
                                <td class="border border-government-gray-300 px-3 py-2">19</td>
                                <td class="border border-gray-300 px-3 py-2">13</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
         <iframe src="../pages/TB_Dash_Footer.html" frameborder="0" style="height: 110px;overflow: auto;"></iframe>
    </div>

    <!-- JavaScript to Render Charts -->
    <script>
        // Data from React Component
        const treatmentTrend = [
            { district: 'Dehradun', started: 180, completing: 150, dropouts: 10 },
            { district: 'Haridwar', started: 144, completing: 120, dropouts: 8 },
            { district: 'Nainital', started: 136, completing: 116, dropouts: 7 },
            { district: 'Almora', started: 170, completing: 144, dropouts: 9 },
            { district: 'Udham Singh Nagar', started: 118, completing: 102, dropouts: 6 }
        ];

        const newCaseRegistrations = [
            { district: 'Dehradun', cases: 500 },
            { district: 'Haridwar', cases: 360 },
            { district: 'Nainital', cases: 340 },
            { district: 'Almora', cases: 425 },
            { district: 'Udham Singh Nagar', cases: 295 },
            { district: 'Pauri Garhwal', cases: 210 },
            { district: 'Tehri Garhwal', cases: 190 }
        ];

        const diagnosticSummary = [
            { district: 'Dehradun', totalCases: 500, cbNaat: 120, xrays: 170 },
            { district: 'Haridwar', totalCases: 360, cbNaat: 86, xrays: 122 },
            { district: 'Nainital', totalCases: 340, cbNaat: 80, xrays: 116 },
            { district: 'Almora', totalCases: 425, cbNaat: 102, xrays: 144 },
            { district: 'Udham Singh Nagar', totalCases: 295, cbNaat: 70, xrays: 100 }
        ];

        const treatmentOutcomes = [
            { name: 'Cured', value: 60, color: '#10B981' },
            { name: 'Under Treatment', value: 30, color: '#3B82F6' },
            { name: 'Dropped Out', value: 10, color: '#EF4444' }
        ];

        // TB Treatment Progress Trend (Line Chart)
        new Chart(document.getElementById('treatmentTrendChart'), {
            type: 'line',
            data: {
                labels: treatmentTrend.map(item => item.district),
                datasets: [
                    {
                        label: 'Treatment Started',
                        data: treatmentTrend.map(item => item.started),
                        borderColor: '#3B82F6',
                        backgroundColor: '#3B82F6',
                        fill: false,
                        tension: 0.1
                    },
                    {
                        label: 'Completing Treatment',
                        data: treatmentTrend.map(item => item.completing),
                        borderColor: '#10B981',
                        backgroundColor: '#10B981',
                        fill: false,
                        tension: 0.1
                    },
                    {
                        label: 'Dropped Out',
                        data: treatmentTrend.map(item => item.dropouts),
                        borderColor: '#EF4444',
                        backgroundColor: '#EF4444',
                        fill: false,
                        tension: 0.1
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        ticks: {
                            autoSkip: false,
                            maxRotation: 45,
                            minRotation: 45,
                            font: { size: 12 }
                        }
                    },
                    y: {
                        beginAtZero: true,
                        max: 200,
                        ticks: { stepSize: 50 }
                    }
                },
                plugins: {
                    legend: { position: 'bottom' }
                }
            }
        });

        // New TB Case Registrations by District (Bar Chart)
        new Chart(document.getElementById('newCaseRegistrationsChart'), {
            type: 'bar',
            data: {
                labels: newCaseRegistrations.map(item => item.district),
                datasets: [{
                    label: 'Cases',
                    data: newCaseRegistrations.map(item => item.cases),
                    backgroundColor: '#8B5CF6',
                    borderColor: '#8B5CF6',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        ticks: {
                            autoSkip: false,
                            maxRotation: 45,
                            minRotation: 45,
                            font: { size: 12 }
                        }
                    },
                    y: {
                        beginAtZero: true,
                        max: 600,
                        ticks: { stepSize: 150 }
                    }
                },
                plugins: {
                    legend: { display: false }
                }
            }
        });

        // District-wise Diagnosis Summary (Horizontal Bar Chart)
        new Chart(document.getElementById('diagnosticSummaryChart'), {
            type: 'bar',
            data: {
                labels: diagnosticSummary.map(item => item.district),
                datasets: [
                    {
                        label: 'Total Cases',
                        data: diagnosticSummary.map(item => item.totalCases),
                        backgroundColor: '#3B82F6',
                        borderColor: '#3B82F6',
                        borderWidth: 1
                    },
                    {
                        label: 'CB-NAAT Tests',
                        data: diagnosticSummary.map(item => item.cbNaat),
                        backgroundColor: '#10B981',
                        borderColor: '#10B981',
                        borderWidth: 1
                    },
                    {
                        label: 'X-rays Conducted',
                        data: diagnosticSummary.map(item => item.xrays),
                        backgroundColor: '#F59E0B',
                        borderColor: '#F59E0B',
                        borderWidth: 1
                    }
                ]
            },
            options: {
                indexAxis: 'y',
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        beginAtZero: true,
                        max: 600,
                        ticks: { stepSize: 150 }
                    },
                    y: {
                        ticks: { font: { size: 12 } }
                    }
                },
                plugins: {
                    legend: { position: 'bottom' }
                }
            }
        });

        // Treatment Outcomes Distribution (Pie Chart)
        new Chart(document.getElementById('treatmentOutcomesChart'), {
            type: 'pie',
            data: {
                labels: treatmentOutcomes.map(item => item.name),
                datasets: [{
                    data: treatmentOutcomes.map(item => item.value),
                    backgroundColor: treatmentOutcomes.map(item => item.color),
                    borderColor: treatmentOutcomes.map(item => item.color),
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { position: 'bottom' },
                    tooltip: {
                        callbacks: {
                            label: function (context) {
                                return `${context.label}: ${context.raw}%`;
                            }
                        }
                    }
                }
            }
        });
    </script>
</body>

</html>